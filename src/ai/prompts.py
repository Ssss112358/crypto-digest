RELEVANCE_TAGGING_PROMPT = r"""
各メッセージを relevance に分類：core / adjacent / off。
基準は意味で判断。キーワード一致は不要。

core: 取引・価格・トークン/プロジェクト・CEX/DEX・KYC/airdrop・規制/セキュリティ・オンチェーン操作・手数料/ベスティング等に直接関与。
adjacent: イベント告知、配信、補助ツールなど周辺で意思決定に影響しうるもの。
off: コミュ雑談（飲み会、家庭ネタ等）で意思決定に寄与しないもの。

返却：{msg_id, relevance}
"""

THREAD_DETECTION_PROMPT = r"""
あなたは会話ログから「話題の束」を動的に見つけて名付ける編集者です。
固定カテゴリは使わず、意味でまとめます。

入力：時系列の短文群（タイムスタンプ付）
出力：JSON（threadsの配列）。各要素 {title, msg_ids[], rationale}

要件：
- 類似内容は同じ thread へ。固有名に依存しすぎないが、識別可能なタイトルにする。
- msg_ids は元の順序を保つ。
- 断片的な更新は既存threadに吸収。新規topicは必要時のみ作成。
- スレッド数は「話題が自然に読める最小限」。
"""

DIGEST_PROMPT = r"""
あなたは暗号コミュニティの編集者。出力は自然文のみ（表・カード不可）。

前提：
- スレッド（title, msg_ids[]）が与えられる（動的に発見済み）。
- 各msgの relevance（core/adjacent/off）も与えられる。

指示：
1) 冒頭に「今日の更新」を1–2段落（WIB基準。※時刻は文中に必要最小限だけ）。
2) 各スレッドを一本の物語に統合。重複は統合し、矛盾は併走で示し、最新を前段に。
3) core だけ本文で詳述。adjacent は末尾に1–2文でまとめる。off は出力しない（admin連絡なら末尾に一行）。
4) 数字・割合・KYC/FCFS・手数料・既知不具合は自然文に織り込む（太字など不要）。
5) 時刻はWIBのみ、同日=HH:MM、別日=MM/DD HH:MM。UTCや(UTC+7)は書かない。
6) 「全体の空気感」は冒頭だけで重複させない。
"""
